---
title: "Prediction of excercise by machine learning"
author: "Ryota"
date: "10/9/2018"
output: html_document
---

## 1.Overview
One thing that people regularly do is quantify how much of a particular activity they do, but they rarely quantify how well they do it. Data for the project is from accelerometers on the belt, forearm, arm, and dumbell of 6 participants. The report will indicate to predict the manner in which they did the exercise. This is the "classe" variable in the training set. K-means clustering is used for the prediction.

##2.Analysis
First of all, the tools required are loaded.
```{r}
library(caret)
library(ggplot2)
```

Then, the data is loaded for both training and testing. 
```{r}
testing <- read.csv("pml-testing.csv")
training <- read.csv("pml-training.csv")
```

Then, the structure of the training data is checked.
```{r}
str(training)
summary(training$classe)
```
We can see the training data has 19622 observations with 160 variables. And, "classe" variables have five classes: A~E.

Then, in order to eliminate the missing value in the training data, below operations were conducted.
```{r}
training2 <- training[ , colSums(is.na(training)) == 0]
write.csv(training2,file="training2.csv")
training3 = read.csv("training2.csv",header = TRUE,na.strings = c("NA","NaN","","#DIV/0!"))
training4 <- training3[ , colSums(is.na(training3)) == 0]
```

In order to categolize the data with five clusters, k-means clustring will be tried.
```{r}
kMeans1 <- kmeans(training4[,c(1:2,4:5,8:60)],centers=5)
training4$clusters <- as.factor(kMeans1$cluster)
qplot(classe,colour=clusters,data=training4)
```
We can see the clustering dose not work well.

To check further, cross table is built. The data shows the k-means clustering does not separate the data well, according to "classe". 
```{r}
modFit <- train(clusters~.,data=subset(training4,select=-c(classe)),method="rpart")
table(predict(modFit,training4),training4$classe)
```

##3.Conclusion
This report tried to predict the data by using the k-means clusitring, but it did not work well. Further reserch and other method shold be needed.